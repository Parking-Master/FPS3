<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPS3 - Multiplayer First Person Shooter game</title>
    <style>
      @font-face {
        font-family: "Roboto";
        src: url(fonts/Roboto.ttf);
      }
      @font-face {
        font-family: "Game";
        src: url(fonts/Game.ttf);
      }
      html, body {
        font-family: "Roboto", Arial;
        overflow: hidden !important;
        user-select: none !important;
        background-image: linear-gradient(to right, #fff, #ddd);
      }
      .wrapper {
        width: 98%;
        height: 97%;
        margin: 0;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1), 0 1px 8px rgba(0, 0, 0, 0.3);
        padding: 0 !important;
        border: 5px solid #333;
        border-image: linear-gradient(to top, #333, #fff) 1 / 20px;
        background: #fefefe;
        background-image: url(images/html/guns.png);
        background-repeat: no-repeat;
        background-size: 500px;
        background-position-x: center;
        background-position-y: -15vh;
      }
      h1 {
        text-align: center;
        font-size: 9em;
        margin: 0;
        color: #fff;
        z-index: 5;
        font-family: "Game", Arial, Helvetica, sans-serif !important;
        padding: 10px 0;
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, .25));
      }
      h2 {
        position: relative;
        text-align: center;
        font-size: 6em;
        margin: 0;
        color: #fff;
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, .25));
        z-index: 500 !important;
        width: 350px;
        left: 50%;
        margin-left: -175px;
        font-family: "Game", Arial, Helvetica, sans-serif !important;
        font-style: italic;
      }
      .main-image {
        width: 45vh;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%);
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, .3)) contrast(120%);
      }
      .strike {
        width: 30%;
        height: 4px;
        position: absolute;
        background: #333;
        top: 12%;
      }
      .strike.str-left {
        left: 5%;
      }
      .strike.str-right {
        right: 5%;
      }
      button.button {
        color: #333 !important;
        position: relative;
        padding: 20px 8px;
        width: 250px;
        border-radius: 10px;
        background: #fff;
        border: 3px solid #333;
        font-size: 18px;
        font-family: "Open Sans Light", Arial;
        font-weight: 100;
        font-size: 18px;
        margin-left: 5%;
        margin-bottom: 20vh;
        transition: transform .1s;
        white-space: nowrap;
        text-transform: uppercase;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1), 0 1px 8px rgba(0, 0, 0, 0.3);
        transition: box-shadow 1s;
        cursor: pointer;
      }
      button.button:hover {
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1), 0 1px 12px rgba(0, 0, 0, 0.35);
      }
      button.button:active {
        transition: box-shadow .3s;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.2);
        background: #eee;
      }
      [class^="loader-"] {
        background: #333;
        height: 100vh;
        position: fixed;
        margin: 0 !important;
        left: 0;
        top: 0;
        z-index: 9999999;
        width: 0;
      }
      .loader-1 {
        width: 200px;
        transition: left 1s ease-in;
      }
      .loader-2 {
        width: 100px;
        transition: left 1.1s ease-in;
      }
      .loader-3 {
        width: 50px;
        transition: left 1.2s ease-in;
      }
      .loader-4 {
        width: 25px;
        transition: left 1.3s ease-in;
      }
      .loader-5 {
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: #111;
        width: 100%;
        height: 100%;
        margin: 0 !important;
        opacity: 1;
        transition: background 2s, backdrop-filter 2s;
        backdrop-filter: blur(15px);
      }
      img {
        pointer-events: none !important;
      }
      .notiflix-confirm-overlay {
        backdrop-filter: blur(5px);
      }
      .notiflix-confirm-head * {
        color: #333 !important;
      }
      .notiflix-confirm-buttons a {
        background: #333 !important;
        border-radius: 2px !important;
      }
      .notiflix-confirm-content {
        border-radius: 5px !important;
      }
      @media only screen and (max-height: 640px) {
        h1 {
          visibility: hidden;
        }
      }
      .arrow {
        border: solid #333;
        border-width: 0 3px 3px 0;
        display: inline-block;
        padding: 3px;
      }
      .hidden-list {
        height: 0;
        margin-top: 10px;
        transition: height .2s, box-shadow 1s;
        visibility: hidden;
        cursor: default !important;
      }
      .mini-button {
        text-decoration: underline;
        text-transform: capitalize;
      }
      .carousel .arrow-holder:hover {
        outline: 1px solid currentColor;
      }
      a:not(.notiflix-confirm-content a) {
        cursor: pointer;
        color: #333 !important;
      }
      b {
        color: #333 !important;
      }
      .snowflake{transform:scale(.1);z-index:999999;position:absolute;pointer-events:none!important}.snowflake{--size:1vw;width:var(--size);height:var(--size);background:#eee;box-shadow:0 0 5px 5px #eee;border-radius:50%;top:-5vh}@keyframes snowfall{0%{transform:translate3d(var(--left-ini),0,0)}100%{transform:translate3d(var(--left-end),110vh,0)}}.snowflake:first-child{--size:0.8vw;--left-ini:-8vw;--left-end:1vw;left:41vw;animation:13s linear -1s infinite snowfall}.snowflake:nth-child(2){--size:0.6vw;--left-ini:6vw;--left-end:1vw;left:72vw;animation:6s linear -2s infinite snowfall}.snowflake:nth-child(3){--size:1vw;--left-ini:5vw;--left-end:-9vw;left:57vw;animation:14s linear -4s infinite snowfall}.snowflake:nth-child(4){--size:0.2vw;--left-ini:2vw;--left-end:4vw;left:66vw;animation:10s linear -8s infinite snowfall}.snowflake:nth-child(5){--size:0.2vw;--left-ini:5vw;--left-end:-3vw;left:40vw;animation:6s linear -2s infinite snowfall}.snowflake:nth-child(6){--size:0.4vw;--left-ini:0vw;--left-end:-4vw;left:12vw;animation:11s linear -4s infinite snowfall}.snowflake:nth-child(7){--size:0.8vw;--left-ini:1vw;--left-end:-7vw;left:15vw;animation:7s linear -5s infinite snowfall}.snowflake:nth-child(8){--size:1vw;--left-ini:9vw;--left-end:-4vw;left:16vw;animation:13s linear -2s infinite snowfall}.snowflake:nth-child(9){--size:0.4vw;--left-ini:0vw;--left-end:-6vw;left:81vw;animation:7s linear -6s infinite snowfall}.snowflake:nth-child(10){--size:1vw;--left-ini:-7vw;--left-end:-5vw;left:14vw;animation:14s linear -1s infinite snowfall}.snowflake:nth-child(11){--size:1vw;--left-ini:-3vw;--left-end:3vw;left:69vw;animation:7s linear -1s infinite snowfall}.snowflake:nth-child(12){--size:0.8vw;--left-ini:-3vw;--left-end:4vw;left:52vw;animation:11s linear -6s infinite snowfall}.snowflake:nth-child(13){--size:0.8vw;--left-ini:4vw;--left-end:5vw;left:14vw;animation:13s linear -3s infinite snowfall}.snowflake:nth-child(14){--size:1vw;--left-ini:2vw;--left-end:-7vw;left:97vw;animation:8s linear -6s infinite snowfall}.snowflake:nth-child(15){--size:0.4vw;--left-ini:-4vw;--left-end:-9vw;left:77vw;animation:6s linear -10s infinite snowfall}.snowflake:nth-child(16){--size:0.8vw;--left-ini:-4vw;--left-end:6vw;left:27vw;animation:7s linear -8s infinite snowfall}.snowflake:nth-child(17){--size:0.8vw;--left-ini:6vw;--left-end:-6vw;left:74vw;animation:15s linear -8s infinite snowfall}.snowflake:nth-child(18){--size:0.4vw;--left-ini:-7vw;--left-end:-5vw;left:9vw;animation:10s linear -7s infinite snowfall}.snowflake:nth-child(19){--size:0.8vw;--left-ini:6vw;--left-end:-1vw;left:1vw;animation:9s linear -7s infinite snowfall}.snowflake:nth-child(20){--size:0.2vw;--left-ini:9vw;--left-end:0vw;left:22vw;animation:13s linear -10s infinite snowfall}.snowflake:nth-child(21){--size:1vw;--left-ini:-4vw;--left-end:5vw;left:96vw;animation:14s linear -8s infinite snowfall}.snowflake:nth-child(22){--size:0.2vw;--left-ini:7vw;--left-end:-8vw;left:15vw;animation:10s linear -6s infinite snowfall}.snowflake:nth-child(23){--size:1vw;--left-ini:0vw;--left-end:2vw;left:26vw;animation:13s linear -10s infinite snowfall}.snowflake:nth-child(24){--size:0.2vw;--left-ini:-4vw;--left-end:7vw;left:60vw;animation:14s linear -4s infinite snowfall}.snowflake:nth-child(25){--size:0.4vw;--left-ini:4vw;--left-end:4vw;left:17vw;animation:13s linear -6s infinite snowfall}.snowflake:nth-child(26){--size:1vw;--left-ini:2vw;--left-end:7vw;left:9vw;animation:10s linear -9s infinite snowfall}.snowflake:nth-child(27){--size:0.8vw;--left-ini:-4vw;--left-end:2vw;left:68vw;animation:10s linear -1s infinite snowfall}.snowflake:nth-child(28){--size:1vw;--left-ini:-8vw;--left-end:2vw;left:86vw;animation:6s linear -5s infinite snowfall}.snowflake:nth-child(29){--size:0.8vw;--left-ini:-4vw;--left-end:-5vw;left:6vw;animation:9s linear -9s infinite snowfall}.snowflake:nth-child(30){--size:1vw;--left-ini:-1vw;--left-end:5vw;left:80vw;animation:7s linear -1s infinite snowfall}.snowflake:nth-child(31){--size:0.6vw;--left-ini:4vw;--left-end:-3vw;left:100vw;animation:9s linear -10s infinite snowfall}.snowflake:nth-child(32){--size:0.2vw;--left-ini:9vw;--left-end:-5vw;left:71vw;animation:11s linear -1s infinite snowfall}.snowflake:nth-child(33){--size:0.4vw;--left-ini:-4vw;--left-end:-6vw;left:30vw;animation:9s linear -5s infinite snowfall}.snowflake:nth-child(34){--size:1vw;--left-ini:-2vw;--left-end:1vw;left:81vw;animation:13s linear -10s infinite snowfall}.snowflake:nth-child(35){--size:0.4vw;--left-ini:-4vw;--left-end:-1vw;left:22vw;animation:12s linear -6s infinite snowfall}.snowflake:nth-child(36){--size:0.4vw;--left-ini:-7vw;--left-end:1vw;left:33vw;animation:14s linear -3s infinite snowfall}.snowflake:nth-child(37){--size:0.8vw;--left-ini:6vw;--left-end:8vw;left:44vw;animation:9s linear -4s infinite snowfall}.snowflake:nth-child(38){--size:0.4vw;--left-ini:4vw;--left-end:-1vw;left:17vw;animation:10s linear -6s infinite snowfall}.snowflake:nth-child(39){--size:0.2vw;--left-ini:2vw;--left-end:-4vw;left:77vw;animation:11s linear -9s infinite snowfall}.snowflake:nth-child(40){--size:1vw;--left-ini:-6vw;--left-end:2vw;left:48vw;animation:8s linear -6s infinite snowfall}.snowflake:nth-child(41){--size:0.8vw;--left-ini:8vw;--left-end:3vw;left:93vw;animation:6s linear -9s infinite snowfall}.snowflake:nth-child(42){--size:1vw;--left-ini:-7vw;--left-end:-9vw;left:80vw;animation:12s linear -3s infinite snowfall}.snowflake:nth-child(43){--size:0.8vw;--left-ini:-3vw;--left-end:-6vw;left:30vw;animation:14s linear -9s infinite snowfall}.snowflake:nth-child(44){--size:1vw;--left-ini:-7vw;--left-end:-9vw;left:70vw;animation:12s linear -8s infinite snowfall}.snowflake:nth-child(45){--size:0.2vw;--left-ini:-4vw;--left-end:2vw;left:17vw;animation:6s linear -6s infinite snowfall}.snowflake:nth-child(46){--size:0.4vw;--left-ini:-8vw;--left-end:3vw;left:4vw;animation:13s linear -2s infinite snowfall}.snowflake:nth-child(47){--size:0.2vw;--left-ini:-6vw;--left-end:-3vw;left:53vw;animation:14s linear -3s infinite snowfall}.snowflake:nth-child(48){--size:0.8vw;--left-ini:8vw;--left-end:-7vw;left:91vw;animation:13s linear -3s infinite snowfall}.snowflake:nth-child(49){--size:0.6vw;--left-ini:2vw;--left-end:9vw;left:95vw;animation:11s linear -6s infinite snowfall}.snowflake:nth-child(50){--size:1vw;--left-ini:-6vw;--left-end:4vw;left:85vw;animation:6s linear -1s infinite snowfall}.snowflake:nth-child(6n){filter:blur(1px)}
      a[disabled] {
        opacity: .5;
        pointer-events: none !important;
      }
      .disabled {
        cursor: not-allowed !important;
      }
      .options, .poll img {
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, .3)) contrast(120%) brightness(150%) !important;
      }
      .swal-overlay {
        z-index: 999 !important;
      }
      [class^="swal"] {
        animation: none !important;
        transition: none !important;
      }
      .swal-button {
        background: #333 !important;
        color: #fff;
        border-radius: 2px;
        box-shadow: none !important;
      }
      .swal-modal {
        border-radius: 1px;
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.24) !important;
      }
      .swal-overlay {
        background: rgba(10, 10, 10, .3);
      }
      .swal-content {
        height: 200px;
        overflow-y: scroll;
        border-bottom: 2px solid #333;
      }
      .mail-body {
        background: #f1f1f1;
        border: .2px solid #999;
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.24) !important;
        margin: 10px;
        padding: 4px;
        position: relative;
        left: 50%;
        margin-left: -160px !important;
      }
      [id^="NotiflixNotify-"] {
        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.24);
        background: transparent !important;
        backdrop-filter: blur(5px);
        border-bottom: .5px solid gold;
      }
      #NotiflixNotifyWrap {
        z-index: 99999999999999999 !important;
      }
      #NotiflixNotifyWrap * {
        color: gold !important;
      }
      .gamepad-focus {
        transform: scale(1.1);
        outline: 6px solid #ddd;
      }
      .poll-option {
        border: 1px solid #333;
        color: #333;
        margin: 5px;
        font-size: 18px;
        padding: 10px;
        cursor: pointer;
      }
      .poll-option:hover {
        background: #efefef;
      }
      .poll-option:active {
        background: #ddd;
      }
      .button__badge {
        background: #fa3e3e;
        border-radius: 2px;
        color: #fff;
        padding: 1px 3px;
        font-size: 10px;
        position: absolute;
        top: 0;
        right: 0;
      }
      .decal-0 {
        position: absolute;
        left: 0;
        bottom: 0;
        width: 40%;
        z-index: 99999;
        margin: 10px;
      }
      .center {
        display: inline-flex;
        text-align: center;
        align-items: center;
        justify-content: center;
      }
      .reward-item {
        position: relative;
        border: 2px solid gold;
        border-radius: 1px;
        cursor: pointer;
        width: 200px;
        padding: 5px;
        left: 50%;
        margin-left: -100px;
      }
      .reward-item:hover {
        border-color: #999;
      }
      .reward-item:active {
        border-color: #777;
        background: #eee;
      }
      .tippy-box[data-theme~="fps"] {
        background: #333;
        border: 1px solid #444;
      }
      .change-room {
        position: relative;
        float: left;
        margin-right: -50px;
        cursor: pointer;
      }
      .change-room:active {
        transform: scale(.9);
      }
      .picture {
        border-radius: 100%;
        border: 2px solid #333;
        width: 50px;
        height: 50px;
      }
      .friend {
        filter: drop-shadow(3px 3px 3px rgba(0, 0, 0, .3)) contrast(120%) brightness(150%) !important;
      }
      .swal-content__input {
        border: 1px solid #333 !important;
        outline: none !important;
      }
      .coin {
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #ffff00;
        border: 1px dotted #333;
      }
    </style>
    <script src="js/user/user.js"></script>
    <script src="js/user/rewards.js"></script>
    <script src="js/help/help.js"></script>
    <script src="js/analytics.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script id="gametimejs" src="https://cdn.jsdelivr.net/gh/Parking-Master/Gametime.js-2.0@latest/gametime.js"></script>
    <script src="js/GamepadMenuControls.js"></script>
    <script src="https://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/TSedlar/pseudo-styler@1.0.7/pseudostyler.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>
  </head>
  <body>
    <div class="loader">
      <div class="loader-5"></div>
    </div>
    <div class="wrapper">
      <img class="options" src="images/icons/hamburger.png" style="position: absolute; left: 2%; top: 2%; width: 50px; cursor: pointer; pointer-events: all !important" onclick="dropdown(this)">
      <img class="rewards" src="images/other/star.png" style="position: absolute; right: 2%; top: 2%; width: 50px; cursor: pointer; pointer-events: all !important" onclick="rewards(this)">
      <img class="friends" src="images/other/add.png" style="position: absolute; right: 2%; bottom: 3%; width: 50px; cursor: pointer; pointer-events: all !important" onclick="openFriends(this)">
      <div class="poll" style="position: absolute; margin-left: 70px; left: 2%; top: 2%; width: 55px; cursor: pointer; pointer-events: all !important; display: inline-block; pointer-events: all !important">
        <img src="images/other/poll.png" style="width: 100%; pointer-events: all !important" onclick="poll(this)">
      </div>
      <h2 style="margin-top: 2%" class="main-title">FPS</h2>
      <h1 style="margin-top: -2%" class="secondary-title">3</h1>
      <div class="strike str-left"></div>
      <div class="strike str-right"></div>
      <img src="images/html/mastery.png" class="main-image" style="margin-top: -60px">
      <img src="images/html/gun.png" class="decal-0" style="margin-top: -60px">
      <div style="margin-top: -100px">
        <button style="position: absolute" class="hidden-list button">
          <br>
          <br>
          <b style="font-family: Arial, Helvetica, sans-serif !important; font-weight: bold; font-size: 12px">Select a mode:</b>
          <br>
          <span class="change-room" onclick="changeRoom()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18 15.422v.983c0 .771-1.862 1.396-4 1.396s-4-.625-4-1.396v-.983c.968.695 2.801.902 4 .902 1.202 0 3.035-.208 4-.902zm-4-1.363c-1.202 0-3.035-.209-4-.902v.973c0 .771 1.862 1.396 4 1.396s4-.625 4-1.396v-.973c-.968.695-2.801.902-4 .902zm0-5.86c-2.138 0-4 .625-4 1.396 0 .77 1.862 1.395 4 1.395s4-.625 4-1.395c0-.771-1.862-1.396-4-1.396zm0 3.591c-1.202 0-3.035-.209-4-.902v.977c0 .77 1.862 1.395 4 1.395s4-.625 4-1.395v-.977c-.968.695-2.801.902-4 .902zm-.5-9.79c-5.288 0-9.649 3.914-10.377 9h-3.123l4 5.917 4-5.917h-2.847c.711-3.972 4.174-7 8.347-7 4.687 0 8.5 3.813 8.5 8.5s-3.813 8.5-8.5 8.5c-3.015 0-5.662-1.583-7.171-3.957l-1.2 1.775c1.916 2.536 4.948 4.182 8.371 4.182 5.797 0 10.5-4.702 10.5-10.5s-4.703-10.5-10.5-10.5z"/></svg>
          </span>
          <a id="mode" onclick="event.preventDefault()" class="carousel"><span class="arrow-holder" onclick="switchMode(this, 'back')"><i class="arrow" style="transform: rotate(135deg)"></i></span> <span class="holder">Slayer</span> <span class="arrow-holder" onclick="switchMode(this, 'go')"><i class="arrow" style="transform: rotate(-45deg)"></i></span></a>
          <br>
          <a class="mini-button" style="margin: 0; font-family: monospace" onclick="start()">Start</a>
        </button>
        <button onclick="play(this)" class="button"><img src="images/html/play.png" style="width: 8%; vertical-align: middle; margin-top: -4px"> play</button>
        <button style="margin-left:0;position:absolute;margin-right:5%!important;right:0!important;position:absolute" class="hidden-list button">
          <br>
          <br>
          <a style="font-family: Arial, Helvetica, sans-serif !important; font-weight: bold; font-size: 12px" href="javascript:login()">Log in/Sign up</a>
          <br>
          <a style="font-family: Arial, Helvetica, sans-serif !important; font-weight: bold; font-size: 12px" href="javascript:settings()">Edit/view Settings</a>
          <br>
          <a style="font-family: Arial, Helvetica, sans-serif !important; font-weight: bold; font-size: 12px" href="javascript:users()">See all users</a>
        </button>
        <button style="margin-left:0;position:absolute;margin-right:5%!important;right:0!important" onclick="customize(this)" class="button"><img src="images/html/options.png" style="width: 8%; vertical-align: middle; margin-top: -4px"> options</button>
        <br>
        <button onclick="store(this)" class="button"><img src="images/html/credit.png" style="width: 8%; vertical-align: middle; margin-top: -4px"> store</button>
        <button onclick="help()" style="margin-left:0;position:absolute;margin-right:5%!important;right:0!important" class="button"><img src="images/html/help.png" style="width: 8%; vertical-align: middle; margin-top: -4px"> help</button>
      </div>
      <p class="copyright" style="position: absolute; text-align: center; margin: 0; top: 90%; font-size: 20px; width: 300px; left: 50%; margin-left: -150px; padding: 0">&copy; 2023 <a href="https://github.com/Parking-Master">Parking-Master</a></p>
    </div>
    <script>
      /* importers */
      import("https://cdn.jsdelivr.net/gh/notiflix/Notiflix@latest/dist/notiflix-aio-3.2.5.min.js");
      import("./js/SessionSearcher.js");

      
      /* Tooltips */
      tippy(".rewards", {
        theme: "fps",
        content: "My rewards"
      });
      tippy(".poll", {
        theme: "fps",
        content: "Daily poll"
      });
      tippy(".options", {
        theme: "fps",
        content: "Other options"
      });

      function coin(from, to, max, delay = 100) {
        let coins = 0;
        let collect = setInterval(() => {
          if (coins >= max) return clearInterval(collect);
          coins++;
          let coin = $("<div class='coin'>").insertAfter($(from)).css({
            left: $(from).offset().left,
            top: $(from).offset().top
          }).animate({
            "top": $(to).offset().top,
            "left": $(to).offset().left
          }, 1000, function() {
            coin.remove();
          });
        }, delay);
      }

      gametime.set("key", "pub-c-672a6dd1-3655-4331-8913-891ad95df31f", "sub-c-6dc7d441-fc41-40f0-94b5-e0357ade8856");
      gametime.set("channel", "world");

      availableModes = ["Slayer", "Fiesta", "Snipers", "Oddball", "Fistfight", "CTF", "KOTH"];
      availableMaps = ["Cargo", "Storage", "Complex", "Lihid", "Aero", "Venus"];
      currentMode = availableModes[0];
      currentMap = availableMaps[0];

      function loader(rate = 200) {
        let loader1 = document.createElement("div");
        let loader2 = document.createElement("div");
        let loader3 = document.createElement("div");
        let loader4 = document.createElement("div");
        let loader5 = document.createElement("div");
        loader1.className = "loader-1";
        document.querySelector(".loader").appendChild(loader1);
        loader2.className = "loader-2";
        document.querySelector(".loader").appendChild(loader2);
        loader3.className = "loader-3";
        document.querySelector(".loader").appendChild(loader3);
        loader4.className = "loader-4";
        document.querySelector(".loader").appendChild(loader4);
        loader5.className = "loader-5";
        document.querySelector(".loader-5") == null && document.querySelector(".loader").appendChild(loader5);
        document.querySelector(".loader-5").style.background = "#111";
        document.querySelector(".loader-5").style.backdropFilter = "blur(15px)";
        document.querySelector(".loader-2").style.left = "0";
        document.querySelector(".loader-1").style.left = "0";
        document.querySelector(".loader-1").style.left = "200%";
        setTimeout(() => {
          document.querySelector(".loader-5").style.background = "transparent";
          document.querySelector(".loader-5").style.backdropFilter = "none";
          document.querySelector(".loader-2").style.left = "200%";
          setTimeout(() => {
            loader1.remove();
            loader2.remove();
            loader3.remove();
            loader4.remove();
            document.querySelector(".loader-5").remove();
          }, 2100);
          setTimeout(() => {
            document.querySelector(".loader-3").style.left = "200%";
          }, rate);
          setTimeout(() => {
            document.querySelector(".loader-4").style.left = "200%";
          }, rate);
        }, rate);
      }
      window.addEventListener("load", () => {
        Notiflix.Loading.init({ svgColor: "#fff" });
        if (userMan.isLoggedIn) {
          getFriends();
          if (localStorage["daily-reward"] && !(Math.round((new Date((new Date()).toLocaleDateString("en-US").split("/")[2], (new Date()).toLocaleDateString("en-US").split("/")[0] - 1, (new Date()).toLocaleDateString("en-US").split("/")[1]) - new Date(localStorage["daily-reward"].split("/")[2], localStorage["daily-reward"].split("/")[0] - 1, localStorage["daily-reward"].split("/")[1])) / (1000 * 60 * 60 * 24)) <= 0)) {
            localStorage.removeItem("daily-reward");
          }
          if (!localStorage["daily-reward"]) {
            let reward = dailyRewards[Math.floor(Math.random() * dailyRewards.length)];
            new Reward("Daily reward", "Here is your daily gift from us!", reward, reward == "points" ? 100 : null);
            localStorage.setItem("daily-reward", new Date().toLocaleDateString("en-US"));
          }
        }
        loader();
        Session.clearCache();
        Notiflix.Notify.init({
          position: "right-top",
          timeout: 5000,
          info: {
            width: "300px",
            background: "transparent",
            textColor: "#fff",
            notiflixIconColor: "gold"
          }
        });

        // Gamepad setup
        GamepadControls = new GamepadMenuControls(["button:nth-of-type(2)", "button:nth-of-type(5)", "button:nth-of-type(4)", "button:nth-of-type(6)", ".frame-close-button", ".frame-reload-button"], false);
        GamepadControls.action = function(type, element) {
          if (type == "click") {
            if (element.textContent.trim().toLowerCase().includes("play")) {
              if (element.previousElementSibling.style.visibility != "visible") {
                GamepadControls.elements.splice(GamepadControls.elements.indexOf(".holder"), 1);
                GamepadControls.elements.splice(GamepadControls.elements.indexOf(".mini-button"), 1);
                GamepadControls.update();
                GamepadControls.focus = 0;
                return;
              }
              document.querySelector(".holder").onclick = function() {
                document.querySelectorAll(".arrow-holder")[1].click();
              };
              GamepadControls.elements.splice(1, 0, ".holder");
              GamepadControls.elements.splice(2, 0, ".mini-button");
              GamepadControls.update();
              GamepadControls.focus = 4;
            }
          }
        }
      });

      function play(button) {
        typeof button.clicked == "undefined" ? button.clicked = false : void(0);
        if (button.clicked) {
          button.querySelectorAll(".arrow").forEach(x => {
            x.style.transform = "rotate(-45deg)";
            setTimeout(() => {
              x.remove();
            }, 250);
          });
          button.previousElementSibling.style.height = "0";
          button.previousElementSibling.style.visibility = "hidden";
          button.style.borderBottom = "";
          button.style.borderBottomLeftRadius = "";
          button.style.borderBottomRightRadius = "";
          button.style.clipPath = "";
          button.style.boxShadow = "";
          return button.clicked = false;
        }
        let i = document.createElement("i");
        i.className = "arrow";
        i.style = "transform: rotate(-45deg); transition: transform .2s; margin-left: 10px";
        !button.querySelector(".arrow") && button.appendChild(i);
        button.previousElementSibling.style.height = "150px";
        button.previousElementSibling.style.visibility = "visible";
        setTimeout(() => {
          i.style.transform = "rotate(45deg)";
        }, 100);
        button.style.borderBottom = "1px dashed #999";
        button.style.borderBottomLeftRadius = "0";
        button.style.borderBottomRightRadius = "0";
        button.style.clipPath = "inset(-5px -5px 0px -5px)";
        button.style.boxShadow = "none";
        button.clicked = true;
      }
      function start() {
        Session.create({
          mode: currentMode,
          map: availableMaps[Math.floor(Math.random() * availableMaps.length)],
          active: false
        });
        currentObjectId = null;
        gametime.make("join");
        gametime.make("joined");
        function joined(data) {
          let extend = new Parse.Object.extend("Lobby");
          let lobby = new extend();
          lobby.set("objectId", data.split(",")[0]);
          document.querySelector(".notiflix-confirm-head").querySelector("h5").textContent = "Match found!";
          document.querySelector(".notiflix-confirm-head").querySelector("div").textContent = "Connecting players... (1/2)";
          setTimeout(() => document.querySelector(".notiflix-confirm-head").querySelector("div").textContent = "Connecting players... (2/2)", 500);
          setTimeout(() => location.assign("./src.html?lobby=" + lobby.get("sessionId") + "&mode=" + lobby.get("query").mode + (data.split(",")[1] ? "&map=Cargo" : "&map=" + lobby.get("query").map) + (data.split(",")[1] ? "&bot=1" : "")), 3000);
        }
        gametime.on("joined", joined);
        gametime.on("join", function(data) {
          if (data.split(",")[0] == gametime.user.position) return;
          let extend = new Parse.Object.extend("Lobby");
          let lobby = new extend();
          lobby.set("objectId", currentObjectId);
          if (data.split(",")[1] == Session.getIds()[Session.getIds().length - 1]) {
            gametime.run("joined", [data.split(",")[2]]);
          }
        });
        Notiflix.Confirm.show("Searching for a match...", "Please wait for the game to start.", "Cancel", () => clearTimeout(botJoin));
        let botWaitTime = (((Math.floor(Math.random() * 10) + Math.floor(Math.random() * 10)) + 24) / 1.3).toFixed(0) - 0;
        let botJoin = setTimeout(() => {
          joined([currentObjectId, true].join());
        }, (botWaitTime + (Math.floor(Math.random() * 2) == 0 ? (Math.floor(Math.random() * 4)) : -(Math.floor(Math.random() * 4)))) * 1000);
        document.querySelector(".notiflix-confirm-head").querySelector("div").innerHTML += "<br><br><a href='./src.html?freeplay=true&mode=" + currentMode + "&map=" + availableMaps[Math.floor(Math.random() * availableMaps.length)] + "'>Free play</a><br><p>Estimated wait time: " + botWaitTime + " seconds</p>";
        document.querySelector("#NXConfirmButtonOk").onclick = () => {
          clearInterval(search);
          Session.clearCache();
          navigator.sendBeacon("https://parseapi.back4app.com/classes/Lobby/" + currentObjectId, JSON.stringify({"_method":"DELETE","_ApplicationId":"NTR81WnvZ9NPy2JNigjx1OQS9BG41TrmSHD6z2ap","_JavaScriptKey":"4xIHZYPRyPpBcBR7bQOY3IKV1VlCFbZRoH6hSrp7","_ClientVersion":"js3.4.4","_InstallationId":"ec732c40-e273-4e15-909f-ba1541651a8c"}));
        };
        let search = setInterval(() => {
          Session.search().then(x => {
            x.forEach(object => {
              let y = new Parse.Object.extend("lobby");
              let current = new y();
              let other = new y();
              current.set("objectId", currentObjectId);
              other.set("objectId", object.id);
              (object.sessionId != current.get("sessionId") && Session.getIds().indexOf(object.sessionId) > -1 && other.destroy());
              gametime.run("join", [gametime.user.position + "," + object.sessionId + "," + object.id]);
            });
          });
        }, 5000);
        window.onbeforeunload = function(e) {
          navigator.sendBeacon("https://parseapi.back4app.com/classes/Lobby/" + currentObjectId, JSON.stringify({"_method":"DELETE","_ApplicationId":"NTR81WnvZ9NPy2JNigjx1OQS9BG41TrmSHD6z2ap","_JavaScriptKey":"4xIHZYPRyPpBcBR7bQOY3IKV1VlCFbZRoH6hSrp7","_ClientVersion":"js3.4.4","_InstallationId":"ec732c40-e273-4e15-909f-ba1541651a8c"}));
          return null;
        }
      }
      let isHost = false;
      let hostCode = null;
      function getCode(type = "host", setCode) {
        gametime.make("start");
        gametime.make("join");
        gametime.on("start", function(data) {
          let map = data.split(",")[0];
          let mode = data.split(",")[1];
          let code = data.split(",")[2];
          document.querySelector(".notiflix-confirm-head").querySelector("h5").textContent = "Match found!";
          document.querySelector(".notiflix-confirm-head").querySelector("div").textContent = "Connecting players... (1/2)";
          setTimeout(() => document.querySelector(".notiflix-confirm-head").querySelector("div").textContent = "Connecting players... (2/2)", 500);
          let link = `./src.html?lobby=${code}&map=${map}&mode=${mode}`;
          setTimeout(() => location.assign(link), 3000);
        });
        gametime.on("join", function(data) {
          let user = data.split(",")[0];
          let code = data.split(",")[1];
          if (user != gametime.user.position) {
            if (isHost && code == hostCode) gametime.run("start", [[currentMap, currentMode, code].join()]);
          }
        });
        if (type == "join") {
          return (() => {
            pubnub.subscribe({
              channels: [setCode],
              timetoken: getCookie("pubnub-time-token"),
              message: function(e) {
                if ("unsubscribe" == e.type) return pubnub.unsubscribe({
                  channel: e.channel
                });
              },
              withPresence: true
            });
            gametime.run("join", [[gametime.user.position, setCode].join()]);
            gametime.run("join", [[gametime.user.position, setCode].join()]);
            gametime.run("join", [[gametime.user.position, setCode].join()]);
          })();
        }
        let code = (Math.random().toFixed(6).split("").reverse().join("")).replace(/=/gi, "").split(".")[0];
        hostCode = code;
        isHost = true;
        pubnub.subscribe({
          channels: [code],
          timetoken: getCookie("pubnub-time-token"),
          message: function(e) {
            if ("unsubscribe" == e.type) return pubnub.unsubscribe({
              channel: e.channel
            });
          },
          withPresence: true
        });
        swal({
          text: "Your code is " + code + ". Invite a player via your friends list, world chat or someone you know, and have them enter this code in the dropdown."
        }).then(() => {
          Notiflix.Confirm.show("Waiting for player(s)...", "Invite a player using code \"" + code + "\"", "Cancel");
        });
      }
      function joinCode() {
        swal({
          text: "Enter room code (XXXXXX):",
          content: "input"
        }).then((code) => {
          Notiflix.Confirm.show("Searching rooms...", "If this room exists, it will automatically connect. Please wait...", "Cancel");
          setTimeout(() => {
            getCode("join", code);
            setTimeout(() => {
              if (!document.querySelector(".notiflix-confirm-head").querySelector("div").textContent.includes("Connecting")) {
                document.querySelector(".notiflix-confirm-head").querySelector("div").textContent = "Error: Could not connect, invalid code";
                document.querySelector("#NXConfirmButtonOk").textContent = "Close";
              }
            }, 1000);
          }, 1000);
        });
        document.querySelector(".swal-content").style = "height: unset; border: none;";
      }
      function switchMode(element, type) {
        let index = availableModes.indexOf(currentMode);
        if (type == "back") {
          if (index - 1 < 0) {
            index = availableModes.length - 1;
          } else {
            index--;
          }
        } else {
          if (index + 1 > (availableModes.length - 1)) {
            index = 0;
          } else {
            index++;
          }
        }
        currentMode = availableModes[index];
        element.parentElement.querySelector(".holder").textContent = currentMode;
      }
      function switchMap(element, type) {
        let index = availableMaps.indexOf(currentMap);
        if (type == "back") {
          if (index - 1 < 0) {
            index = availableMaps.length - 1;
          } else {
            index--;
          }
        } else {
          if (index + 1 > (availableMaps.length - 1)) {
            index = 0;
          } else {
            index++;
          }
        }
        currentMap = availableMaps[index];
        element.parentElement.querySelector(".holder").textContent = currentMap;
      }
      (() => {
        let frame = document.createElement("iframe");
        let reloadButton = document.createElement("button");
        let closeButton = document.createElement("button");
        frame.style = `
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background: #fff;
        z-index: 9999999999999999999;
        border: 0;
        transition: opacity 1s;
        `;
        closeButton.style = `
        position: absolute;
        margin: 0;
        left: 20px;
        top: 20px;
        z-index: 9999999999999999999;
        border: 1px solid #333;
        color: #333;
        border-radius: 4px;
        padding: 5px;
        background: #fff;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.25);
        cursor: pointer;
        width: 25px;
        `;
        reloadButton.style = `
        position: absolute;
        margin: 0;
        left: 20px;
        top: 60px;
        z-index: 9999999999999999999;
        border: 1px solid #333;
        color: #333;
        border-radius: 4px;
        padding: 5px;
        background: #fff;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1), 0 1px 4px rgba(0, 0, 0, 0.25);
        cursor: pointer;
        width: 25px;
        `;
        closeButton.innerHTML = "&lt;";
        reloadButton.innerHTML = "&circlearrowleft;";
        frame.style.display = "none";
        reloadButton.style.display = "none";
        closeButton.style.display = "none";
        reloadButton.className = "frame-reload-button";
        closeButton.className = "frame-close-button";
        reloadButton.addEventListener("click", () => frame.src = frame.src);
        closeButton.addEventListener("click", function() {
          refresh();
          frame.style.display = "none";
          reloadButton.style.display = "none";
          closeButton.style.display = "none";
        });
        window.addEventListener("message", (e) => {
          if (e.data == "closeFrame") {
            closeButton.click();
          }
        });
        document.body.appendChild(frame);
        document.body.appendChild(reloadButton);
        document.body.appendChild(closeButton);
        window.Frame = function(url) {
          document.body.appendChild(frame);
          document.body.appendChild(reloadButton);
          document.body.appendChild(closeButton);
          Notiflix.Loading.hourglass();
          frame.src = url;
          console.log(frame)
          frame.onload = function() {
            frame.style.display = "block";
            reloadButton.style.display = "block";
            closeButton.style.display = "block";
            if (navigator.getGamepads()[0] && cursorMode) {
              let cursorSync = setInterval(() => {
                if (frame.contentWindow.document.querySelector(".gamepad-cursor") != null) {
                  GamepadControls.disable();
                  frame.contentWindow.GamepadControls.toggleCursor();
                  frame.contentWindow.GamepadControls.setCursorPosition(document.querySelector(".gamepad-cursor").style.left.split("px")[0] - 0, document.querySelector(".gamepad-cursor").style.top.split("px")[0] - 0);
                  clearInterval(cursorSync);
                }
              });
            }
          };
        };
      })();
      function store() {
        new Frame("store.html");
      }
      function settings() {
        new Frame("settings.html");
      }
      function login() {
        new Frame("login.html?return=javascript:parent.postMessage('closeFrame', '*')");
      }
      function logout() {
        userMan.logOut(true);
      }
      function chat() {
        new Frame("chat.html");
      }
      function users() {
        new Frame("users.html");
      }
      function customize(button) {
        typeof button.clicked == "undefined" ? button.clicked = false : void(0);
        if (button.clicked) {
          button.querySelectorAll(".arrow").forEach(x => {
            x.style.transform = "rotate(-45deg)";
            setTimeout(() => {
              x.remove();
            }, 250);
          });
          button.previousElementSibling.style.height = "0";
          button.previousElementSibling.style.visibility = "hidden";
          button.style.borderBottom = "";
          button.style.borderBottomLeftRadius = "";
          button.style.borderBottomRightRadius = "";
          button.style.clipPath = "";
          button.style.boxShadow = "";
          return button.clicked = false;
        }
        let i = document.createElement("i");
        i.className = "arrow";
        i.style = "transform: rotate(-45deg); transition: transform .2s; margin-left: 10px";
        !button.querySelector(".arrow") && button.appendChild(i);
        button.previousElementSibling.style.height = "150px";
        button.previousElementSibling.style.visibility = "visible";
        setTimeout(() => {
          i.style.transform = "rotate(45deg)";
        }, 100);
        button.style.borderBottom = "1px dashed #999";
        button.style.borderBottomLeftRadius = "0";
        button.style.borderBottomRightRadius = "0";
        button.style.clipPath = "inset(-5px -5px 0px -5px)";
        button.style.boxShadow = "none";
        button.clicked = true;
      }
      function dropdown(element) {
        if (document.querySelector(".dropdown") != null) return document.querySelector(".dropdown").remove();
        let box = document.createElement("div");
        box.className = "dropdown";
        box.style = `
        line-height: 120px;
        position: absolute;
        text-align: center;
        left: ${(getComputedStyle(element).left.split("px")[0] - 0) + (getComputedStyle(element).width.split("px")[0] - 0) + 20}px;
        top: ${getComputedStyle(element).top};
        width: 100px;
        height: 120px;
        background: #fff;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1), 0 1px 8px rgba(0, 0, 0, 0.3);
        border: 1px solid #333;
        padding: 5px;
        `;
        box.innerHTML = `
        <div style="display: inline-block; vertical-align: middle; line-height: normal">
          <a href="javascript:chat()">World chat</a>
          <br>
          <span class="disabled"><a href="javascript:logout()" ${!userMan.isLoggedIn ? "disabled" : ""}>Log out user</a></span>
          <br>
          <a href="javascript:mail()">Mail inbox</a>
          <br>
          <a href="javascript:profile()">My profile</a>
        </div>
        `;
        document.body.appendChild(box);
      }
      function profile() {
        new Frame("profile.html");
      }
      window.addEventListener("load", function() {
        if (userMan.isLoggedIn) {
          userMan.update(["tuser", "tpass"], function(key, value) {});
          if (localStorage["temp-rewards"]) {
            let rewards = JSON.parse(localStorage["temp-rewards"]);
            rewards.medals = [...new Set(rewards.medals)];
            userMan.get("metadata").history.medals.forEach(x => {
              if (rewards.medals.indexOf(x.trim()) > -1) {
                rewards.medals.splice(rewards.medals.indexOf(x.trim()), 1);
              }
            });
            let oldRewards = userMan.get("metadata");
            rewards.medals.forEach(medal => {
              oldRewards.history.medals.push(medal);
            });
            oldRewards.points += rewards.points;
            oldRewards.history.kills += rewards.kills || 0;
            userMan.set("metadata", oldRewards, () => {});
            console.log(userMan.get("metadata").history)
            localStorage.removeItem("temp-rewards");
            setTimeout(() => {
              Notiflix.Confirm.show("Level up", `You earned ${rewards.points} points and ${rewards.medals.length} medals!`, "Redeem");
              document.querySelector("#NXConfirmButtonOk").onclick = (e) => {
                coin(document.querySelector(".button[onclick='play(this)']"), document.querySelector(".rewards"), 300 / 10, 50);
              };
              document.querySelector("#NXConfirmButtonOk").style = `
              color: goldenrod;
              border: 2px solid goldenrod !important;
              background: gold !important;
              font-size: 15px;
              `;
            }, 2000);
          }
          let style = document.createElement("link");
          style.rel = "stylesheet";
          if (userMan.get("metadata").preferences.theme.toLowerCase().trim() == "auto") {
            let date = new Date();
            if (date.getHours() >= 18 || date.getHours() <= 6) {
              style.href = "styles/themes/dark.css";
            } else {
              style.href = "styles/themes/light.css";
            }
            document.body.appendChild(style);
            return;
          }
          style.href = "styles/themes/" + userMan.get("metadata").preferences.theme.toLowerCase().trim() + ".css";
          document.body.appendChild(style);
        }
      });
      function refresh(cache = false) {
        if (!cache) return location.replace("/");
        fetch("/").then(function(response) {
          return response.text();
        }).then(function(body) {
          let newBody = body;
          document.open();
          document.write(body);
          document.close();
          window.dispatchEvent(new Event("load"));
        });
      }
      function openMail(mail, style, element) {
        mail = JSON.parse(atob(mail));
        style = decodeURIComponent(atob(style));
        element.style = "transition: transform 1s; transform: scale(2); position: absolute; z-index: 9999999999999; border: 1px solid #000; top: 35%; background-image: none; background: #fff; width: 200px; margin-left: -110px !important";
        let close = document.createElement("span");
        close.style = "cursor: pointer; position: relative; float: left; top: 0; margin: 0";
        let e = element.getAttribute("onclick");
        element.onclick = (e) => event.preventDefault();
        close.onclick = function() {
          element.style = style;
          element.querySelector("p").textContent = mail.message.slice(0, 15) + "...";
          element.removeChild(close);
          setTimeout(() => element.onclick = new Function(e), 500);
        }
        close.innerHTML = "&times;";
        element.insertBefore(close, element.firstChild);
        element.querySelector("p").textContent = mail.message;
        if (mail.sender.toLowerCase().trim() == "friend request") {
          element.querySelector("p").innerHTML += `
          <br>
          <br>
          <a href="#" onclick="(this.parentElement.parentElement.remove(), deleteMail('TW9ua2V5eiUyMHdhbnRzJTIwdG8lMjBhZGQlMjB5b3UlMjBhcyUyMGZyaWVuZA=='))">Decline</a> - <a href="#" onclick="addFriend('${mail.message.split(" ")[0].trim()}', () => (this.parentElement.parentElement.remove(), deleteMail('${btoa(encodeURIComponent(mail.message))}')))">Accept</a>
          `;
        }
      }
      function clearMail() {
        userMan.set("mail", [], () => {
          document.querySelectorAll(".mail-body").forEach(x => x.remove());
        }, ["tuser", "tpass"]);
      }
      function deleteMail(mail) {
        mail = decodeURIComponent(atob(mail));
        let oldMail = userMan.get("mail");
        userMan.get("mail").forEach(x => {
          if (x.message == mail) {
            oldMail.splice(oldMail.indexOf(x), 1);
          }
        });
        setTimeout(() => {
          userMan.set("mail", oldMail, () => {}, ["tuser", "tpass"]);
        }, 200);
      }
      function mail() {
        let content = document.createElement("div");
        content.innerHTML = `
        <a href="javascript:clearMail()">Delete everything</a>
        `;
        let style = "transition: transform 1s; background-image: url(images/other/mail.png); background-size: 300px; background-repeat: no-repeat; background-position: center; width: 300px; height: 150px";
        userMan.get("mail").forEach(mail => {
          content.innerHTML += `
          <div class="mail-body" onclick="openMail('${btoa(JSON.stringify(mail))}', '${btoa(encodeURIComponent(style))}', this)" style="${style}">
            <h3 style="font-size: 14px">${mail.sender}</h3>
            <p style="font-size: 12px">${mail.message.slice(0, 15)}...</p>
          </div>
          `;
        })
        swal({
          title: "Mail",
          content: content
        });
      }
      polls = [
        {
          title: "What is your favorite heavy weapon?",
          options: ["Rocket Pistol", "Grenade Launcher", "Turret", "Vehicle"]
        },
        {
          title: "What is your favorite part of the game?",
          options: ["Style", "Misc", "Peformance", "Graphics", "Simpleness", "Everything"]
        },
        {
          title: "What is your favorite mode?",
          options: availableModes
        },
        {
          title: "What is your favorite map?",
          options: availableMaps
        },
        {
          title: "Do you like bots/AI?",
          options: ["Yes", "No"]
        },
        {
          title: "How would you rate this game?",
          options: ["Awesome!", "Very good", "Good", "Not great", "Bad", "Very bad"]
        },
        {
          title: "If you had infinite credits, what would you do with them?",
          options: ["Buy out everything", "Keep earning", "Give them away", "Nothing"]
        },
        {
          title: "How difficult is this game?",
          options: ["Simple", "Easy", "Normal", "Difficult", "Hard"]
        },
        {
          title: "What is your favorite in-game weapon?",
          options: ["Assault Rifle", "Glock 19", "Sniper Rifle", "Micro Uzi", "Auto Pistol", "Light Machine Gun", "Shotgun", "Rocket Pistol", "Grenade Launcher", "Wire_Rifle", "Turret", "Knife", "Ball", "Tactical Shotgun", "Humvee", "Hand Grenade"]
        }
      ];
      if (!(localStorage["pollAnswered"] && Math.round((new Date((new Date()).toLocaleDateString("en-US").split("/")[2], (new Date()).toLocaleDateString("en-US").split("/")[0] - 1, (new Date()).toLocaleDateString("en-US").split("/")[1]) - new Date(localStorage["pollAnswered"].split("/")[2], localStorage["pollAnswered"].split("/")[0] - 1, localStorage["pollAnswered"].split("/")[1])) / (1000 * 60 * 60 * 24)) <= 0)) {
        document.querySelector(".poll").innerHTML += `
        <span class="button__badge">1</span>
        `;
      }
      function poll() {
        if (localStorage["pollAnswered"] && Math.round((new Date((new Date()).toLocaleDateString("en-US").split("/")[2], (new Date()).toLocaleDateString("en-US").split("/")[0] - 1, (new Date()).toLocaleDateString("en-US").split("/")[1]) - new Date(localStorage["pollAnswered"].split("/")[2], localStorage["pollAnswered"].split("/")[0] - 1, localStorage["pollAnswered"].split("/")[1])) / (1000 * 60 * 60 * 24)) <= 0) {
          return swal({
            title: "Oops!",
            text: "You've already answered today's poll. Come back tomorrow for more!"
          });
        }
        swal({
          title: "Daily poll",
          text: "Earn 100 credits from answering daily poll",
          buttons: ["Cancel", "Start"]
        }).then(e => {
          if (e) {
            let poll = polls[Math.floor(Math.random() * polls.length)];
            let content = document.createElement("div");
            poll.options.forEach(x => {
              content.innerHTML += `
              <div class="poll-option" onclick="pollOption()">${x}</div>
              `;
            });
            swal({
              title: poll.title,
              content: content,
              button: false
            });
          }
        });
        document.querySelector(".swal-text").innerHTML += `
        <br><br><small><i><span style="color: #ff0000">*</span>Credits are only awarded if you are logged in.</i></small>
        `;
      }
      function pollOption() {
        Notiflix.Block.circle(".swal-modal");
        if (userMan.isLoggedIn) {
          metadata = userMan.get("metadata");
          metadata.points = BigInt((metadata.points - 0) + 100).toString();
          userMan.set("metadata", metadata, () => {}, ["tuser", "tpass"]);
        }
        setTimeout(() => {
          document.querySelector(".button__badge").remove();
          if (!userMan.isLoggedIn) return swal({
            title: "Thank you!",
            text: "Thank you for answering the daily poll."
          });
          swal({
            title: "Congrats!",
            text: "You earned 100 credits"
          });
        }, 2000);
        localStorage.setItem("pollAnswered", (new Date()).toLocaleDateString("en-US"));
      }
      function rewards() {
        if (!userMan.isLoggedIn) return swal({
          title: "No rewards",
          text: "To view rewards, you must be signed in.",
          button: "Close"
        });
        let content = document.createElement("div");
        content.innerHTML = `
        <div style="padding-top: 10px; position: relative; left: 50%; margin-left: -150px; width: 300px; height: 150px; border: 3px solid #ddd; border-radius: 3px">
        </div>
        `;
        swal({
          title: "Your rewards",
          text: "Welcome! When you earn special rewards, they'll appear here.",
          content: content,
          button: "Close"
        });
        if (userMan.get("metadata").rewards.length < 1) {
          content.querySelector("div").innerHTML = "<i>No rewards available</i>";
        } else {
          userMan.get("metadata").rewards.forEach(reward => {
            content.querySelector("div").innerHTML += `
            <div class="reward-item" style="margin-bottom: 5px">
              <img src="${reward.gift.type == "points" ? "images/html/credit.png" : `images/store/${reward.gift.item.split(".")[0].toLowerCase().trim() + "s"}/${reward.gift.item.split(".")[1].trim()}.png`}" style="width: 4%">
              <b onclick="openReward('${btoa(encodeURIComponent(JSON.stringify(reward)))}', this.parentElement)">${reward.title}</b>
            </div>
            `;
          });
        }
      }
      function openReward(reward, item) {
        reward = JSON.parse(decodeURIComponent(atob(reward)));
        if (reward.gift.type == "points") {
          metadata = userMan.get("metadata");
          metadata.points = BigInt((metadata.points - 0) + (reward.gift.value - 0)).toString();
          Notiflix.Confirm.show("Reward redeemed", "You earned " + reward.gift.value + " points!", "OK");
          item.remove();
          metadata.rewards.splice(metadata.rewards.indexOf(reward), 1);
          userMan.set("metadata", metadata, () => {}, ["tuser", "tpass"]);
        } else {
          metadata = userMan.get("metadata");
          !(metadata.preferences.items.indexOf(reward.gift.item) > -1) && metadata.preferences.items.push(reward.gift.item);
          Notiflix.Confirm.show("Reward redeemed", "You earned " + (reward.gift.value == 1 ? "a" : reward.gift.value) + " " + reward.gift.item.split(".")[1].replace(/_/, " ") + " " + reward.gift.item.split(".")[0].toLowerCase().trim() + (reward.gift.value == 1 ? "" : "s") + "!", "OK");
          item.remove();
          metadata.rewards.splice(metadata.rewards.indexOf(reward), 1);
          userMan.set("metadata", metadata, () => {}, ["tuser", "tpass"]);
        }
      }
      dailyRewards = ["points", "points", "points", "points", "points", "Loadout.Sniper_Rifle-Shotgun", "points", "points", "points", "points", "points", "points", "Character.Max", "points", "points", "points", "points", "Theme.Auto"];
      room = {
        type: 1,
        content: document.querySelector(".hidden-list").cloneNode()
      };
      function changeRoom() {
        if (room.type == 1) {
          let oldContent = document.querySelector(".hidden-list").innerHTML;
          document.querySelector(".hidden-list").innerHTML = `
          <br style="margin-bottom: 10px">
          <b style="font-family: Arial, Helvetica, sans-serif !important; font-weight: bold; font-size: 12px">Custom game</b>
          <br>
          <span class="change-room" onclick="changeRoom()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18 15.422v.983c0 .771-1.862 1.396-4 1.396s-4-.625-4-1.396v-.983c.968.695 2.801.902 4 .902 1.202 0 3.035-.208 4-.902zm-4-1.363c-1.202 0-3.035-.209-4-.902v.973c0 .771 1.862 1.396 4 1.396s4-.625 4-1.396v-.973c-.968.695-2.801.902-4 .902zm0-5.86c-2.138 0-4 .625-4 1.396 0 .77 1.862 1.395 4 1.395s4-.625 4-1.395c0-.771-1.862-1.396-4-1.396zm0 3.591c-1.202 0-3.035-.209-4-.902v.977c0 .77 1.862 1.395 4 1.395s4-.625 4-1.395v-.977c-.968.695-2.801.902-4 .902zm-.5-9.79c-5.288 0-9.649 3.914-10.377 9h-3.123l4 5.917 4-5.917h-2.847c.711-3.972 4.174-7 8.347-7 4.687 0 8.5 3.813 8.5 8.5s-3.813 8.5-8.5 8.5c-3.015 0-5.662-1.583-7.171-3.957l-1.2 1.775c1.916 2.536 4.948 4.182 8.371 4.182 5.797 0 10.5-4.702 10.5-10.5s-4.703-10.5-10.5-10.5z"/></svg>
          </span>
          <div style="transform: scale(.6); margin: 0">Mode: <a id="mode" onclick="event.preventDefault()" class="carousel"><span class="arrow-holder" onclick="switchMode(this, 'back')"><i class="arrow" style="transform: rotate(135deg)"></i></span> <span class="holder">Slayer</span> <span class="arrow-holder" onclick="switchMode(this, 'go')"><i class="arrow" style="transform: rotate(-45deg)"></i></span></a></div>
          <div style="transform: scale(.6); margin: 0">Map: <a id="mode" onclick="event.preventDefault()" class="carousel"><span class="arrow-holder" onclick="switchMap(this, 'back')"><i class="arrow" style="transform: rotate(135deg)"></i></span> <span class="holder">Cargo</span> <span class="arrow-holder" onclick="switchMap(this, 'go')"><i class="arrow" style="transform: rotate(-45deg)"></i></span></a></div>
          <a class="mini-button" style="transform: scale(.7); margin: 0; font-family: monospace" onclick="getCode()">Get code</a> | <a class="mini-button" style="transform: scale(.7); margin: 0; font-family: monospace" onclick="joinCode()">Join code</a>
          `;
          room = {
            type: 0,
            content: oldContent
          };
        } else if (room.type == 0) {
          let oldContent = document.querySelector(".hidden-list").innerHTML;
          document.querySelector(".hidden-list").innerHTML = room.content;
          room = {
            type: 1,
            content: oldContent
          };
        }
      }
      let friendsList = [];
      function addFriend(newFriend, callback = () => {}) {
        let oldFriends = JSON.parse(JSON.stringify(friendsList));
        oldFriends.push(newFriend);
        userMan.set("friends", oldFriends, () => callback(), ["tuser", "tpass"]);
        (async () => {
          const t = Parse.Object.extend("User");
          const n = new Parse.Query(t);
          const s = await n.find();
          for (let t = 0; t < s.length; t++) {
            const n = Parse.Object.extend("User");
            new Parse.Query(n).get(s[t].id).then((t => {
              if (t.get("tuser").trim() == newFriend.trim()) {
                Parse.User.logIn(t.get("username"), t.get("tpass")).then(user => {
                  let oldFriends = user.get("friends");
                  oldFriends.push(userMan.get("tuser"));
                  user.set("friends", oldFriends);
                  user.save();
                });
              }
            }));
          }
        })();
      }
      function getFriends() {
        let friends = userMan.get("friends");
        friends.forEach(x => typeof x == "string" && friendsList.push(x));
      }
      function openFriends() {
        let content = document.createElement("div");
        (async () => {
          const t = Parse.Object.extend("User");
          const n = new Parse.Query(t);
          const s = await n.find();
          for (let t = 0; t < s.length; t++) {
            const n = Parse.Object.extend("User");
            new Parse.Query(n).get(s[t].id).then((t => {
              if (friendsList.indexOf(t.get("tuser").trim()) > -1) {
                Parse.User.logIn(t.get("username"), t.get("tpass")).then(user => {
                  content.innerHTML += `
                  <div class="friend friend-${friendsList.indexOf(user.get("tuser").trim())}" style="position: absolute; margin-left: 30px; left: ${friendsList.indexOf(user.get("tuser").trim()) * 12}%; top: 25%; width: 55px; cursor: pointer; pointer-events: all !important; display: inline-block; pointer-events: all !important" data-user="${user.get("tuser")}">
                    <img src="${user.get("picture")}" class="picture">
                    <span class="button__badge" style="background: #00ff00">&plus;</span>
                  </div>
                  `;
                  content.querySelectorAll(".friend").forEach(x => {
                    tippy(x, {
                      theme: "fps",
                      content: x.dataset.user,
                      placement: "bottom"
                    });
                  });
                });
              }
            }));
          }
        })();
        swal({
          title: "My friends",
          content: content
        });
      }
    </script>
    <div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div><div class="snowflake"></div>
    <div class="simple-keyboard"></div>
  </body>
</html>