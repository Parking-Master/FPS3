THREE.GamepadControls=function(t){this.rotMatrix=new THREE.Matrix4,this.dir=new THREE.Vector3(0,0,1),this.tmpVector=new THREE.Vector3,this.object=t,this.lon=-90,this.lat=0,this.target=new THREE.Vector3,this.threshold=.05,this.init=function(){navigator.getGamepads||!!navigator.webkitGetGamepads||!!navigator.webkitGamepads?this.startPolling():console.log("NOT SUPPORTED")},this.startPolling=function(){this.ticking||(this.ticking=!0,this.tick())},this.stopPolling=function(){this.ticking=!1},this.tick=function(){this.pollStatus(),this.scheduleNextTick()},this.scheduleNextTick=function(){this.ticking&&requestAnimationFrame(this.tick.bind(this))},this.pollStatus=function(){this.pollGamepads()},this.filter=function(t){return Math.abs(t)>this.threshold?t:0},this.pollGamepads=function(){var t=navigator.getGamepads&&navigator.getGamepads()||navigator.webkitGetGamepads&&navigator.webkitGetGamepads();if(t&&t[0]){var i=t[0];if(GamepadControls.isLocked){this.lon+=this.filter(i.axes[2]),this.lat-=this.filter(i.axes[3])}this.lat=Math.max(-85,Math.min(85,this.lat));var s=(90-this.lat)*Math.PI/180,a=this.lon*Math.PI/180;this.target.x=10*Math.sin(s)*Math.cos(a),this.target.y=10*Math.cos(s),this.target.z=10*Math.sin(s)*Math.sin(a),this.target.add(this.object.position),Math.abs(t[0].axes[2].toFixed(2))<=.01||Math.abs(t[0].axes[3].toFixed(2))<=.01||this.object.lookAt(this.target),this.rotMatrix.extractRotation(this.object.matrix),/*this.dir.set(this.filter(i.axes[0]),0,this.filter(i.axes[1])),*/this.dir.multiplyScalar(.1),this.dir.applyMatrix4(this.rotMatrix),this.object.position.add(this.dir)}},this.init();return{}},THREE.GamepadControls.prototype=Object.create(THREE.EventDispatcher.prototype);